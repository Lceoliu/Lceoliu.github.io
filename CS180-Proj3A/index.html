

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/lc.jpg">
  <link rel="icon" href="/img/lc.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Chang Leo">
  <meta name="keywords" content="">
  
    <meta name="description" content="CS180 Lab 3 - Part A Overview It&#39;s trivial for us to do several types of geometric transformations: translation, rotation, scaling, skewing, etc. They can all be represented as matrix multiplicati">
<meta property="og:type" content="website">
<meta property="og:title" content="CS180-Proj3A">
<meta property="og:url" content="https://lceoliu.github.io/CS180-Proj3A/index.html">
<meta property="og:site_name" content="Chang&#39;s Blog">
<meta property="og:description" content="CS180 Lab 3 - Part A Overview It&#39;s trivial for us to do several types of geometric transformations: translation, rotation, scaling, skewing, etc. They can all be represented as matrix multiplicati">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/7/79/Hauck_Neue_Constructionen_der_Perspective_fig1a.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180s1.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180s2.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k1.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k2.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS1801.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS1802.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/taskA2_correspondences.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA2_correspondences.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA2_correspondences_station.png">
<meta property="og:image" content="https://miro.medium.com/v2/resize:fit:720/format:webp/0*7uAm0FHBq_XmhcxS.jpg">
<meta property="og:image" content="https://miro.medium.com/v2/resize:fit:640/format:webp/0*PJE50me94RGCfC2Z">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180chess_output.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180bridge_taskA3_comparison_bilinear.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180kitchen_taskA3_comparison_bilinear.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180station_taskA3_comparison_bilinear.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA4_alpha1_feather.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA4_mosaic_feather.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA4_mosaic_laplacian2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k_taskA4_mosaic_feather.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k_taskA4_mosaic_laplacian2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180result_f_s.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180result.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180spherical_result.jpg">
<meta property="article:published_time" content="2025-10-08T23:19:23.000Z">
<meta property="article:modified_time" content="2025-10-08T23:20:25.460Z">
<meta property="article:author" content="Chang Leo">
<meta property="article:tag" content="notes">
<meta property="article:tag" content="CS180">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/7/79/Hauck_Neue_Constructionen_der_Perspective_fig1a.png">
  
  
  
  <title>CS180-Proj3A - Chang&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />





<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"lceoliu.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"9HyUa6m2LMnz9pU9dVwuqyEV-gzGzoHsz","app_key":"LHEhgO1t44IynNOlOy97ZJT1","server_url":null,"path":"window.location.pathname","ignore_local":true},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/node-tikzjax@latest/css/fonts.css" /><style>.tikzjax { display: block; text-align: center; user-select: none; }</style></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav
  id="navbar"
  class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"
>
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Chang</strong>
    </a>

    <button
      id="navbar-toggler-btn"
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
           
        <li class="nav-item">
          <a class="nav-link" href="/">
            <i class="iconfont icon-home-fill"></i> 首页</a
          >
          <!--以上的部分是一级导航的部分-->
          <!--这里判断有没有二级菜单，有的话遍历出二级菜单（就是竖着的那部分）-->
          
        </li>
           
        <li class="nav-item">
          <a class="nav-link" href="/archives/">
            <i class="iconfont icon-archive-fill"></i> 归档</a
          >
          <!--以上的部分是一级导航的部分-->
          <!--这里判断有没有二级菜单，有的话遍历出二级菜单（就是竖着的那部分）-->
          
        </li>
           
        <li class="nav-item">
          <a class="nav-link" href="/categories/">
            <i class="iconfont icon-category-fill"></i> 分类</a
          >
          <!--以上的部分是一级导航的部分-->
          <!--这里判断有没有二级菜单，有的话遍历出二级菜单（就是竖着的那部分）-->
          
          <ul class="sub-menu">
            <!--//遍历出二级菜单（就是竖着的那部分）-->
            
            <li>
              <!--//a标签里当然是输出二级菜单的路径咯-->
              <a href="/categories/Blogs/">
                <!--//i标签里输出二级菜单的icon的class咯-->
                <i class="iconfont icon-category-fill"></i>
                <!--//这里输出二级菜单名咯-->
                Blogs
              </a>
            </li>
            
            <li>
              <!--//a标签里当然是输出二级菜单的路径咯-->
              <a href="/categories/Papers/">
                <!--//i标签里输出二级菜单的icon的class咯-->
                <i class="iconfont icon-category-fill"></i>
                <!--//这里输出二级菜单名咯-->
                Papers
              </a>
            </li>
            
            <li>
              <!--//a标签里当然是输出二级菜单的路径咯-->
              <a href="/categories/Game%20Devs/">
                <!--//i标签里输出二级菜单的icon的class咯-->
                <i class="iconfont icon-category-fill"></i>
                <!--//这里输出二级菜单名咯-->
                Game Devs
              </a>
            </li>
            
          </ul>
          
        </li>
           
        <li class="nav-item">
          <a class="nav-link" href="/tags/">
            <i class="iconfont icon-tags-fill"></i> 标签</a
          >
          <!--以上的部分是一级导航的部分-->
          <!--这里判断有没有二级菜单，有的话遍历出二级菜单（就是竖着的那部分）-->
          
        </li>
           
        <li class="nav-item">
          <a class="nav-link" href="/about/">
            <i class="iconfont icon-user-fill"></i> 关于</a
          >
          <!--以上的部分是一级导航的部分-->
          <!--这里判断有没有二级菜单，有的话遍历出二级菜单（就是竖着的那部分）-->
          
        </li>
           
        <li class="nav-item">
          <a class="nav-link" href="/links/">
            <i class="iconfont icon-link-fill"></i> 友链</a
          >
          <!--以上的部分是一级导航的部分-->
          <!--这里判断有没有二级菜单，有的话遍历出二级菜单（就是竖着的那部分）-->
          
        </li>
         
        <li class="nav-item" id="search-btn">
          <a
            class="nav-link"
            target="_self"
            href="javascript:;"
            data-toggle="modal"
            data-target="#modalSearch"
            aria-label="Search"
          >
            <i class="iconfont icon-search"></i>
          </a>
        </li>
          
        <li class="nav-item" id="color-toggle-btn">
          <a
            class="nav-link"
            target="_self"
            href="javascript:;"
            aria-label="Color Toggle"
          >
            <i class="iconfont icon-dark" id="color-toggle-icon"></i>
          </a>
        </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CS180-Proj3A"></span>
          
        </div>

        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      <div class="container nopadding-x-md">
        <div id="board"
          >
          
          <div class="container">
            <div class="row">
              <div class="col-12 col-md-10 m-auto">
                

<article class="page-content">
  <h1 id="cs180-lab-3---part-a">CS180 Lab 3 - Part A</h1>
<h2 id="overview">Overview</h2>
<p>It's trivial for us to do several types of geometric transformations:
translation, rotation, scaling, skewing, etc. They can all be
represented as matrix multiplications. However, when we want to stitch
two or more images from different viewpoints together, we need to use a
more general transformation called <strong>homography</strong>.</p>
<h2 id="some-math">Some math</h2>
<h3 id="homography">Homography</h3>
<p>From Wikipedia:</p>
<blockquote>
<p>In the field of computer vision, any two images of the same planar
surface in space are related by a homography (assuming a pinhole camera
model).</p>
</blockquote>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/7/79/Hauck_Neue_Constructionen_der_Perspective_fig1a.png" srcset="/img/loading.gif" lazyload alt="Homography">
<figcaption aria-hidden="true">Homography</figcaption>
</figure>
<p>The homography is a function <span class="math inline">\(h\)</span>
that maps points into points, with the property that if points <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> are colinear, then the transformed
points <span class="math inline">\(h(x)\)</span>, <span class="math inline">\(h(y)\)</span>, and <span class="math inline">\(h(z)\)</span> are <strong>also colinear</strong>.
So the function <span class="math inline">\(h\)</span> can be
represented as a matrix multiplication:</p>
<p><span class="math display">\[
\begin{bmatrix}
x&#39;/w&#39; \\
y&#39;/w&#39; \\
1
\end{bmatrix}
\longleftrightarrow
\begin{bmatrix}
x&#39; \\
y&#39; \\
w&#39;
\end{bmatrix}
= H \begin{bmatrix}
x \\
y \\
1
\end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(H\)</span> is a 3x3 matrix, and
<span class="math inline">\((x&#39;, y&#39;, w&#39;)\)</span> are the
transformed coordinates in homogeneous coordinates.</p>
<h3 id="how-to-compute-h">How to compute H?</h3>
<p>First, we suppose H is:</p>
<p><span class="math display">\[
H = \begin{bmatrix}
h_{11} &amp; h_{12} &amp; h_{13} \\
h_{21} &amp; h_{22} &amp; h_{23} \\
h_{31} &amp; h_{32} &amp; h_{33}
\end{bmatrix}
\]</span></p>
<p>Then we assume we have <span class="math inline">\(n\)</span> pairs
of corresponding points <span class="math inline">\((x_i, y_i)\)</span>
and <span class="math inline">\((x&#39;_i, y&#39;_i)\)</span>, where
<span class="math inline">\(i = 1, 2, ..., n\)</span>. Each pair gives
us two equations:</p>
<p><span class="math display">\[
x&#39;_i = \frac{h_{11} x_i + h_{12} y_i + h_{13}}{h_{31} x_i + h_{32}
y_i + h_{33}}
\]</span></p>
<p><span class="math display">\[
y&#39;_i = \frac{h_{21} x_i + h_{22} y_i + h_{23}}{h_{31} x_i + h_{32}
y_i + h_{33}}
\]</span></p>
<p>so we can define <span class="math inline">\(h\)</span> as:</p>
<p><span class="math display">\[h = [h_{11}, h_{12}, h_{13}, h_{21},
h_{22}, h_{23}, h_{31}, h_{32}, h_{33}]^T\]</span></p>
<p>Thus, we can get a system of linear equations <span class="math inline">\(Ah = 0\)</span>, where <span class="math inline">\(A\)</span> is a <span class="math inline">\(2n
\times 9\)</span> matrix below:</p>
<p><span class="math display">\[
A = \begin{bmatrix}
x_1 &amp; y_1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; -x&#39;_1 x_1 &amp;
-x&#39;_1 y_1 &amp; -x&#39;_1 \\
0 &amp; 0 &amp; 0 &amp; x_1 &amp; y_1 &amp; 1 &amp; -y&#39;_1 x_1 &amp;
-y&#39;_1 y_1 &amp; -y&#39;_1 \\
\cdots &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  &amp;  \\
x_n &amp; y_n &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; -x&#39;_n x_n &amp;
-x&#39;_n y_n &amp; -x&#39;_n \\
0 &amp; 0 &amp; 0 &amp; x_n &amp; y_n &amp; 1 &amp; -y&#39;_n x_n &amp;
-y&#39;_n y_n &amp; -y&#39;_n
\end{bmatrix}
\]</span></p>
<p>And we can solve this by SVD. The solution is the right singular
vector corresponding to the smallest singular value of <span class="math inline">\(A\)</span>. (Finally, we need to reshape <span class="math inline">\(h\)</span> back to a 3x3 matrix <span class="math inline">\(H\)</span>.)</p>
<p>Also, from the above, we can see that we need at least 4 pairs of
corresponding points to solve for <span class="math inline">\(H\)</span>. (every pair gives us 2 equations, and
we have 8 degrees of freedom)</p>
<hr>
<h2 id="a.1-shoot-and-digitize-pictures">A.1 Shoot and Digitize
Pictures</h2>
<p>I prepared three image pairs with large planar overlap:</p>
<ul>
<li>Bridge: the provided OpenCV panorama example for a controlled
baseline (panning around a riverside walkway).</li>
<li>Kitchen: two handheld shots of my kitchen counter taken a few inches
apart while rotating the camera about the optical center.</li>
<li>Table: a tabletop arrangement with books and a monitor, again
acquired by pivoting the camera to keep the motion approximately
projective.</li>
</ul>
<p>Representative inputs are shown below (left/right are the two source
images in each pair):</p>
<p><img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180s1.jpg" srcset="/img/loading.gif" lazyload>
<img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180s2.jpg" srcset="/img/loading.gif" lazyload>
<img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k1.jpg" srcset="/img/loading.gif" lazyload>
<img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k2.jpg" srcset="/img/loading.gif" lazyload>
<img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS1801.jpg" srcset="/img/loading.gif" lazyload>
<img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS1802.jpg" srcset="/img/loading.gif" lazyload></p>
<h2 id="a.2-recover-homographies">A.2 Recover Homographies</h2>
<p>Correspondences come either from manual clicking (JSON files in
<code>test_data/.../*.json</code>) or from <code>cv2.BFMatcher</code> to
save some time (because precise manual annotation is hard for me). The
correspondence are shown below:</p>
<ul>
<li><p>Bridge: <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/taskA2_correspondences.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Kitchen: <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA2_correspondences.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Station: <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA2_correspondences_station.png" srcset="/img/loading.gif" lazyload></p></li>
</ul>
<p>The estimated homographies are:</p>
<p><span class="math display">\[
H_{bridge} = \begin{bmatrix}
1.000517151994700926e+00 &amp; 1.934651821424284305e-05 &amp;
-4.292858059440893612e+02 \\
-1.347010553204711417e-04 &amp; 1.000425656962335097e+00 &amp;
-1.110208515622688845e-02 \\
-4.040777547417956760e-07 &amp; 9.404293585180129630e-07 &amp;
1.000000000000000000e+00
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
H_{kitchen} = \begin{bmatrix}
1.383290749963294042e+00 &amp; 3.287087757504674745e-01 &amp;
-4.954696332897179900e+02 \\
-2.480568995413748590e-01 &amp; 1.054769919125850830e+00 &amp;
4.261829110969327417e+02 \\
5.365628407611597794e-04 &amp; -2.587039299089656324e-04 &amp;
1.000000000000000000e+00
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
H_{station} = \begin{bmatrix}
2.051488129129804605e+00 &amp; -2.166269545193346968e-01 &amp;
-7.714051347860786336e+02 \\
5.373060026078243512e-01 &amp; 1.568850300184745361e+00 &amp;
-3.035902657823175446e+02 \\
1.117455412546467962e-03 &amp; -2.327306688189019295e-04 &amp;
1.000000000000000000e+00
\end{bmatrix}
\]</span></p>
<p>The estimator (<code>utils.py::find_homography</code>)
repeatedly:</p>
<ol type="1">
<li>Samples four correspondences (with degeneracy checks).</li>
<li>Solves a normalized DLT system via SVD.</li>
<li>Scores inliers with a forward reprojection threshold.</li>
<li>Refits the homography on the winning consensus set.</li>
</ol>
<p>All three homographies preserve projective structure well enough for
stitching.</p>
<h2 id="a.3-warp-and-rectify-images">A.3 Warp and Rectify Images</h2>
<h3 id="what-is-inverse-warping">What is Inverse Warping?</h3>
<p>Given a source image <code>im</code> and a homography <code>H</code>
mapping source pixels to target pixels, the goal is to produce a new
image <code>out</code> that shows the source from the target's
perspective. The naive forward mapping approach (looping over every
pixel in <code>im</code>, applying <code>H</code>, and writing to
<code>out</code>) can leave holes because some target pixels may not be
hit. Instead, inverse warping loops over every pixel in
<code>out</code>, applies the inverse homography <code>H^&#123;-1&#125;</code> to
find the corresponding pixel in <code>im</code>, and samples the color
there. This guarantees that every pixel in <code>out</code> is
filled.</p>
<h3 id="nn-vs-bilinear">NN vs Bilinear</h3>
<p>The NN (nearest neighbour) works like this: <img src="https://miro.medium.com/v2/resize:fit:720/format:webp/0*7uAm0FHBq_XmhcxS.jpg" srcset="/img/loading.gif" lazyload></p>
<p>and bilinear interpolation works like this: <img src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*PJE50me94RGCfC2Z" srcset="/img/loading.gif" lazyload></p>
<p>A simple view of NN vs bilinear warping of a chessboard pattern is
shown below:</p>
<p><img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180chess_output.png" srcset="/img/loading.gif" lazyload></p>
<p>Obviously bilinear is smoother, but NN is faster and avoids
introducing new colors (which can be helpful for segmentation). I used
bilinear for all final mosaics.</p>
<h3 id="practical-results">Practical Results</h3>
<ul>
<li><p>Bridge: <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180bridge_taskA3_comparison_bilinear.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Kitchen: <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180kitchen_taskA3_comparison_bilinear.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Station: <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180station_taskA3_comparison_bilinear.png" srcset="/img/loading.gif" lazyload></p></li>
</ul>
<h2 id="a.4-blend-images-into-a-mosaic">A.4 Blend Images into a
Mosaic</h2>
<p>The mosaicer (<code>blend_utils.build_mosaic</code>) projects every
image into a common canvas, warps per-image alpha masks, and blends
either by:</p>
<ul>
<li>Feathering: simple weighted averaging driven by the warped alpha
falloff.</li>
<li>Laplacian (two-level): blur the alphas, blend low/high bands
separately to reduce ghosting.</li>
</ul>
<h3 id="procedure">Procedure</h3>
<ol type="1">
<li><p>Unify the coordinate system and canvas size by projecting all
image corners and finding the bounding box. That is, multiply
<code>H</code> with the four corners, find the final bounding
box.</p></li>
<li><p>Warp each image and its alpha mask into the common canvas using
inverse warping.</p></li>
<li><p>Use a linear falloff alpha mask that is 1 at the center and 0 at
the edges, then warp it to the canvas. Shows like this:</p>
<p><img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA4_alpha1_feather.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Blend the images using either feathering or Laplacian blending.
For Laplacian blending, the low-frequency band is blended with the
blurred alpha masks, and the high-frequency band is blended with the
sharp alpha masks.</p></li>
</ol>
<h3 id="practical-results-1">Practical Results</h3>
<ul>
<li><p>Bridge (feathering): <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA4_mosaic_feather.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Bridge (Laplacian): <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180taskA4_mosaic_laplacian2.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Kitchen (feathering): <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k_taskA4_mosaic_feather.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Kitchen (Laplacian): <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180k_taskA4_mosaic_laplacian2.png" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Station (feathering): <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180result_f_s.jpg" srcset="/img/loading.gif" lazyload></p></li>
<li><p>Station (Laplacian): <img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180result.jpg" srcset="/img/loading.gif" lazyload></p></li>
</ul>
<h2 id="further-thoughts">Further Thoughts</h2>
<ol type="1">
<li>I tried to implement spherical warping. The code refers to an
open-source implementation <a target="_blank" rel="noopener" href="https://github.com/OpenStitching/stitching">here</a>. It works
better on Station image:</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Lceoliu/blog-img/main/CS180spherical_result.jpg" srcset="/img/loading.gif" lazyload></p>
<ol start="2" type="1">
<li>Plan to implement exposure compensation and multi-band blending in
next project.</li>
</ol>


  

</article>



              </div>
            </div>
          </div>
        </div>
      </div>
    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/Lceoliu" target="_blank" rel="nofollow noopener"><span>My Github</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
